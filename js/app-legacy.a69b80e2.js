(function(){"use strict";var e={7097:function(e,t,n){n(6992),n(8674),n(9601),n(7727);var r=n(8935),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[n("div",{staticClass:"d-flex align-center"},[n("v-toolbar-title",{staticClass:"ml-3"},[e._v("SNYK Demo")])],1),n("v-spacer")],1),n("v-main",[n("router-view")],1)],1)},a=[],i={name:"App",data:function(){return{}}},s=i,c=n(1001),l=(0,c.Z)(s,o,a,!1,null,null,null),u=l.exports,d=n(2809),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-row",[n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog.show,callback:function(t){e.$set(e.dialog,"show",t)},expression:"dialog.show"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v("Component code")])]),n("v-card-text",[n("pre",[e._v("            "),n("code",[e._v("\n            "+e._s(e.dialog.code)+"\n            ")]),e._v("\n          ")]),n("hr"),n("h3",[e._v("Vulnerability")]),n("p",[e._v(" "+e._s(e.dialog.description)+" ")])])],1)],1),n("v-col",{staticClass:"mx-auto",attrs:{cols:"6"}},[n("br"),n("br"),n("v-row",{staticClass:"text-center"},[n("v-text-field",{attrs:{label:"FL0 Bearer Token",type:"text","prepend-icon":"mdi-lock"},on:{change:e.refresh_org_list},model:{value:e.bearer_token,callback:function(t){e.bearer_token=t},expression:"bearer_token"}})],1),n("v-row",[n("v-select",{attrs:{items:e.organizations,label:"Organization","item-text":"name","item-value":"id"},on:{change:e.fetchProjects},scopedSlots:e._u([e.is_org_loading?{key:"selection",fn:function(){return[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"16"}})]},proxy:!0}:null],null,!0),model:{value:e.selected_org,callback:function(t){e.selected_org=t},expression:"selected_org"}})],1)],1)],1),n("div",{staticClass:"d-flex align-center justify-center",staticStyle:{width:"100%"}},[e.selected_project?n("v-btn",{staticClass:"success",on:{click:e.scanProject}},[e.is_vulns_loading?[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"16"}})]:[e._v(" Scan Project ")]],2):e._e()],1),n("v-row",{staticStyle:{width:"100%",height:"70vh"}},[n("v-col",{attrs:{cols:"3"}},[n("h3",[e._v("Projects")]),e.is_proj_loading?[n("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"primary"}})]:[n("br"),n("hr"),n("br"),e._l(e.projects,(function(t,r){return n("div",{key:r},[n("v-btn",{class:e.selected_project&&t.id===e.selected_project.id?"primary":"",attrs:{text:"",small:"",width:"100%"},on:{click:function(n){return e.selectProject(t)}}},[e._v(" "+e._s(t.name)+" ")]),n("br"),n("br")],1)})),0===e.projects.length?[n("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",border:"left"}},[e._v(" Please select an organization. ")])]:e._e()]],2),n("v-col",{attrs:{cols:"4"}},[n("h3",[e._v("Dependencies")]),n("br"),n("hr"),n("br"),n("v-data-table",{attrs:{headers:e.headers,items:e.items}},[n("template",{slot:"no-data"},[e.is_deps_loading?[n("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}})]:e.selected_project?[n("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",icon:"mdi-information",border:"left"}},[e._v(" No dependencies found. ")])]:[n("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",border:"left"}},[e._v(" Please select a project. ")])]],2)],2)],1),n("v-col",[n("h3",[e._v("Scan Results")]),n("br"),n("hr"),n("br"),n("div",[e.project_scanned?e.is_vulns_loading?[n("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}})]:e.vulns.length>0||e.code_vulns.length>0?[e.code_vulns.length>0?n("v-card",[n("v-card-title",[n("span",{staticClass:"subheading"},[e._v("Code Vulnerabilities found")])]),n("v-card-text",[n("v-data-table",{attrs:{dense:"","disable-pagination":"","hide-default-footer":"",headers:e.code_vuln_headers,items:e.code_vulns},on:{"click:row":e.showDialog}})],1)],1):e._e(),n("hr"),e.vulns.length>0?n("v-card",[n("v-card-title",[n("span",{staticClass:"subheading"},[e._v("Vulnerabilities found")])]),n("v-card-text",[n("v-data-table",{attrs:{dense:"","disable-pagination":"","hide-default-footer":"",headers:e.vuln_headers,items:e.vulns}})],1)],1):e._e()]:e.vulns_done_loading?n("v-card",[n("v-card-title",[n("span",{staticClass:"subheading"},[e._v("No vulnerabilities found")])])],1):e._e():n("v-card",[n("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",border:"left"}},[e._v(" Please select a project and click Scan Project. ")])],1)],2)])],1)],1)},f=[],h=n(6198),v=(n(8975),n(1539),n(4747),n(2222),n(8309),n(1249),n(8783),n(3948),n(9714),n(2526),n(1817),n(6166)),_=n.n(v),g=n(9914),m={name:"HomeView",components:{},data:function(){return{bearer_token:"",workspace_id:"",selected_org:null,organizations:[],projects:[],selected_project:null,project_scanned:!1,is_org_loading:!1,is_deps_loading:!1,is_proj_loading:!1,is_vulns_loading:!1,vulns_done_loading:!0,dialog:{show:!1,code:"",description:""},vulns:[],vuln_headers:[{text:"Package",value:"package"},{text:"Severity",value:"severity"},{text:"Title",value:"title"},{text:"Fixed in",value:"fixedIn"}],code_vulns:[],code_vuln_headers:[{text:"Vulnerability",value:"type"},{text:"Description",value:"description"}],headers:[{value:"name",text:"Name"},{value:"version",text:"Version"}],items:[]}},mounted:function(){this.bearer_token=localStorage.getItem("bearer_token"),this.refresh_org_list()},methods:{refresh_org_list:function(){var e=this;this.is_org_loading=!0,_().get("https://portal.fl0.com/api/me",{headers:{Authorization:"".concat(this.bearer_token)}}).then((function(t){localStorage.setItem("bearer_token",e.bearer_token),e.organizations=t.data.organizations,e.is_org_loading=!1})).catch((function(e){console.log(e)}))},fetchProjects:function(){var e=this;this.selected_org&&(this.is_proj_loading=!0,_().get("https://portal.fl0.com/api/me/organizations/".concat(this.selected_org,"/workspaces"),{headers:{Authorization:"".concat(this.bearer_token)}}).then((function(t){e.projects=t.data.workspaces,e.is_proj_loading=!1})).catch((function(t){console.log(t),e.is_proj_loading=!1})))},selectProject:function(e){this.selected_project=e,this.fetchDependencies(),this.project_scanned=!1},fetchDependencies:function(){var e=this;this.selected_project&&(this.is_deps_loading=!0,_().get("https://portal.fl0.com/api/workspaces/".concat(this.selected_project.id,"/nodeServer"),{headers:{Authorization:"".concat(this.bearer_token)}}).then((function(t){e.items=t.data.npmPackages,e.is_deps_loading=!1})).catch((function(t){e.is_deps_loading=!1,console.log(t)})))},scanProject:function(){var e=this;this.selected_project&&(this.is_vulns_loading=!0,this.vulns_done_loading=!1,this.fetchNodeJsCodes().then((function(t){t.forEach((function(t){e.fetchVulns(t).then((function(n){n.code=t,e.code_vulns=e.code_vulns.concat(n)}))}))})).finally((function(){e.is_vulns_loading=!1,e.project_scanned=!0})),this.items.forEach((function(t){_().get("https://api.fl0.com/eliastest/uat/snyktest/flows/scan?name=".concat(t.name,"&version=").concat(t.version)).then((function(t){var n=t.data.map((function(e){return{package:"".concat(e.name,"@").concat(e.version),severity:e.severityWithCritical,title:e.title,fixedIn:e.fixedIn?e.fixedIn:""}}));e.vulns=e.vulns.concat(n),e.is_vulns_loading=!1})).catch((function(e){console.log(e)})).finally((function(){e.vulns_done_loading=!0}))})))},fetchNodeJsCodes:function(){var e=this;return(0,h.Z)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchFlows();case 2:return n=t.sent,r=[],n.forEach((function(e){e.steps.forEach((function(e){e.parameters&&e.parameters.forEach((function(e){"script"===e.key&&r.push(e.expression)}))}))})),console.log(r),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))()},fetchFlows:function(){var e=this;return(0,h.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.selected_project.id,t.abrupt("return",_().get("https://portal.fl0.com/api/workspaces/".concat(n,"/resourceTree"),{headers:{Authorization:"".concat(e.bearer_token)}}).then(function(){var t=(0,h.Z)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[],t.next=3,Promise.all(n.data.folders.map(function(){var t=(0,h.Z)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(n.resources.map(function(){var t=(0,h.Z)(regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchFlowFromEndpoint(n.id);case 2:o=t.sent,o&&r.push(o);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){return console.log("Error fetching resources",e),[]})));case 2:case"end":return t.stop()}}),t)})))()},fetchFlowFromEndpoint:function(e){var t=this;return(0,h.Z)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.selected_project.id,n.abrupt("return",_().get("https://portal.fl0.com/api/workspaces/".concat(r,"/flows/").concat(e),{headers:{Authorization:"".concat(t.bearer_token)}}).then((function(e){return e.data})).catch((function(e){return console.log("Error fetching flow",e),!1})));case 2:case"end":return n.stop()}}),n)})))()},fetchVulns:function(e){return(0,h.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",_().post("https://api.fl0.com/eliastest/uat/snyktest/flows/scan-js-code",{code_content:g.Buffer.from(e).toString("base64")}).then((function(t){console.log("Response",t);var n=t.data.map((function(t){if(t)return{type:t.ruleId,description:t.message.text,code:e}}));return n})).catch((function(e){return console.log(e),[]})));case 1:case"end":return t.stop()}}),t)})))()},showDialog:function(e){console.log("Clicked",e),this.dialog.show=!0,this.dialog.code=e.code,this.dialog.description=e.description}},watch:{bearer_token:function(e){localStorage.setItem("bearer_token",e)},workspace_id:function(e){localStorage.setItem("workspace_id",e)}}},b=m,w=(0,c.Z)(b,p,f,!1,null,null,null),k=w.exports;r["default"].use(d.Z);var y=[{path:"/",name:"home",component:k}],x=new d.Z({mode:"history",base:"/snyk-demo/",routes:y}),j=x,C=n(4665);r["default"].use(C.ZP);var P=new C.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}}),S=n(8209),F=n.n(S);n(243);r["default"].use(F());var R=new(F())({theme:{themes:{light:{primary:"#007BFF",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}}});r["default"].config.productionTip=!1,new r["default"]({router:j,store:P,vuetify:R,render:function(e){return e(u)}}).$mount("#app")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,function(){var e=[];n.O=function(t,r,o,a){if(!r){var i=1/0;for(u=0;u<e.length;u++){r=e[u][0],o=e[u][1],a=e[u][2];for(var s=!0,c=0;c<r.length;c++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](r[c])}))?r.splice(c--,1):(s=!1,a<i&&(i=a));if(s){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,a,i=r[0],s=r[1],c=r[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(c)var u=c(n)}for(t&&t(r);l<i.length;l++)a=i[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},r=self["webpackChunksnyk_demo"]=self["webpackChunksnyk_demo"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(7097)}));r=n.O(r)})();
//# sourceMappingURL=app-legacy.a69b80e2.js.map