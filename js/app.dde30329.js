(function(){"use strict";var e={7097:function(e,t,s){var o=s(8935),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",[s("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[s("div",{staticClass:"d-flex align-center"},[s("v-toolbar-title",{staticClass:"ml-3"},[e._v("SNYK Demo")])],1),s("v-spacer")],1),s("v-main",[s("router-view")],1)],1)},a=[],n={name:"App",data:()=>({})},i=n,l=s(1001),c=(0,l.Z)(i,r,a,!1,null,null,null),d=c.exports,u=s(2809),h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{fluid:"","fill-height":""}},[s("v-row",[s("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog.show,callback:function(t){e.$set(e.dialog,"show",t)},expression:"dialog.show"}},[s("v-card",[s("v-card-title",[s("span",{staticClass:"headline"},[e._v("Component code")])]),s("v-card-text",[s("pre",[e._v("            "),s("code",[e._v("\n            "+e._s(e.dialog.code)+"\n            ")]),e._v("\n          ")]),s("hr"),s("h3",[e._v("Vulnerability")]),s("p",[e._v(" "+e._s(e.dialog.description)+" ")])])],1)],1),s("v-col",{staticClass:"mx-auto",attrs:{cols:"6"}},[s("br"),s("br"),s("v-row",{staticClass:"text-center"},[s("v-text-field",{attrs:{label:"FL0 Bearer Token",type:"text","prepend-icon":"mdi-lock"},on:{change:e.refresh_org_list},model:{value:e.bearer_token,callback:function(t){e.bearer_token=t},expression:"bearer_token"}})],1),s("v-row",[s("v-select",{attrs:{items:e.organizations,label:"Organization","item-text":"name","item-value":"id"},on:{change:e.fetchProjects},scopedSlots:e._u([e.is_org_loading?{key:"selection",fn:function(){return[s("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"16"}})]},proxy:!0}:null],null,!0),model:{value:e.selected_org,callback:function(t){e.selected_org=t},expression:"selected_org"}})],1)],1)],1),s("div",{staticClass:"d-flex align-center justify-center",staticStyle:{width:"100%"}},[e.selected_project?s("v-btn",{staticClass:"success",on:{click:e.scanProject}},[e.is_vulns_loading?[s("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"16"}})]:[e._v(" Scan Project ")]],2):e._e()],1),s("v-row",{staticStyle:{width:"100%",height:"70vh"}},[s("v-col",{attrs:{cols:"3"}},[s("h3",[e._v("Projects")]),e.is_proj_loading?[s("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"primary"}})]:[s("br"),s("hr"),s("br"),e._l(e.projects,(function(t,o){return s("div",{key:o},[s("v-btn",{class:e.selected_project&&t.id===e.selected_project.id?"primary":"",attrs:{text:"",small:"",width:"100%"},on:{click:function(s){return e.selectProject(t)}}},[e._v(" "+e._s(t.name)+" ")]),s("br"),s("br")],1)})),0===e.projects.length?[s("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",border:"left"}},[e._v(" Please select an organization. ")])]:e._e()]],2),s("v-col",{attrs:{cols:"4"}},[s("h3",[e._v("Dependencies")]),s("br"),s("hr"),s("br"),s("v-data-table",{attrs:{headers:e.headers,items:e.items}},[s("template",{slot:"no-data"},[e.is_deps_loading?[s("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}})]:e.selected_project?[s("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",icon:"mdi-information",border:"left"}},[e._v(" No dependencies found. ")])]:[s("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",border:"left"}},[e._v(" Please select a project. ")])]],2)],2)],1),s("v-col",[s("h3",[e._v("Scan Results")]),s("br"),s("hr"),s("br"),s("div",[e.project_scanned?e.is_vulns_loading?[s("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}})]:e.vulns.length>0||e.code_vulns.length>0?[e.code_vulns.length>0?s("v-card",[s("v-card-title",[s("span",{staticClass:"subheading"},[e._v("Code Vulnerabilities found")])]),s("v-card-text",[s("v-data-table",{attrs:{dense:"","disable-pagination":"","hide-default-footer":"",headers:e.code_vuln_headers,items:e.code_vulns},on:{"click:row":e.showDialog}})],1)],1):e._e(),s("hr"),e.vulns.length>0?s("v-card",[s("v-card-title",[s("span",{staticClass:"subheading"},[e._v("Vulnerabilities found")])]),s("v-card-text",[s("v-data-table",{attrs:{dense:"","disable-pagination":"","hide-default-footer":"",headers:e.vuln_headers,items:e.vulns}})],1)],1):e._e()]:e.vulns_done_loading?s("v-card",[s("v-card-title",[s("span",{staticClass:"subheading"},[e._v("No vulnerabilities found")])])],1):e._e():s("v-card",[s("v-alert",{staticClass:"ma-0",attrs:{value:!0,type:"info",border:"left"}},[e._v(" Please select a project and click Scan Project. ")])],1)],2)])],1)],1)},p=[],v=s(6166),_=s.n(v);const f=s(9914);var g={name:"HomeView",components:{},data(){return{bearer_token:"",workspace_id:"",selected_org:null,organizations:[],projects:[],selected_project:null,project_scanned:!1,is_org_loading:!1,is_deps_loading:!1,is_proj_loading:!1,is_vulns_loading:!1,vulns_done_loading:!0,dialog:{show:!1,code:"",description:""},vulns:[],vuln_headers:[{text:"Package",value:"package"},{text:"Severity",value:"severity"},{text:"Title",value:"title"},{text:"Fixed in",value:"fixedIn"}],code_vulns:[],code_vuln_headers:[{text:"Vulnerability",value:"type"},{text:"Description",value:"description"}],headers:[{value:"name",text:"Name"},{value:"version",text:"Version"}],items:[]}},mounted(){this.bearer_token=localStorage.getItem("bearer_token"),this.refresh_org_list()},methods:{refresh_org_list(){this.is_org_loading=!0,_().get("https://portal.fl0.com/api/me",{headers:{Authorization:`${this.bearer_token}`}}).then((e=>{localStorage.setItem("bearer_token",this.bearer_token),this.organizations=e.data.organizations,this.is_org_loading=!1})).catch((e=>{console.log(e)}))},fetchProjects(){this.selected_org&&(this.is_proj_loading=!0,_().get(`https://portal.fl0.com/api/me/organizations/${this.selected_org}/workspaces`,{headers:{Authorization:`${this.bearer_token}`}}).then((e=>{this.projects=e.data.workspaces,this.is_proj_loading=!1})).catch((e=>{console.log(e),this.is_proj_loading=!1})))},selectProject(e){this.selected_project=e,this.fetchDependencies(),this.project_scanned=!1},fetchDependencies(){this.selected_project&&(this.is_deps_loading=!0,_().get(`https://portal.fl0.com/api/workspaces/${this.selected_project.id}/nodeServer`,{headers:{Authorization:`${this.bearer_token}`}}).then((e=>{this.items=e.data.npmPackages,this.is_deps_loading=!1})).catch((e=>{this.is_deps_loading=!1,console.log(e)})))},scanProject(){this.selected_project&&(this.is_vulns_loading=!0,this.vulns_done_loading=!1,this.fetchNodeJsCodes().then((e=>{e.forEach((e=>{this.fetchVulns(e).then((t=>{t.code=e,this.code_vulns=this.code_vulns.concat(t)}))}))})).finally((()=>{this.is_vulns_loading=!1,this.project_scanned=!0})),this.items.forEach((e=>{_().get(`https://api.fl0.com/eliastest/uat/snyktest/flows/scan?name=${e.name}&version=${e.version}`).then((e=>{let t=e.data.map((e=>({package:`${e.name}@${e.version}`,severity:e.severityWithCritical,title:e.title,fixedIn:e.fixedIn?e.fixedIn:""})));this.vulns=this.vulns.concat(t),this.is_vulns_loading=!1})).catch((e=>{console.log(e)})).finally((()=>{this.vulns_done_loading=!0}))})))},async fetchNodeJsCodes(){let e=await this.fetchFlows(),t=[];return e.forEach((e=>{e.steps.forEach((e=>{e.parameters&&e.parameters.forEach((e=>{"script"===e.key&&t.push(e.expression)}))}))})),console.log(t),t},async fetchFlows(){let e=this.selected_project.id;return _().get(`https://portal.fl0.com/api/workspaces/${e}/resourceTree`,{headers:{Authorization:`${this.bearer_token}`}}).then((async e=>{let t=[];return await Promise.all(e.data.folders.map((async e=>Promise.all(e.resources.map((async e=>{let s=await this.fetchFlowFromEndpoint(e.id);s&&t.push(s)})))))),t})).catch((e=>(console.log("Error fetching resources",e),[])))},async fetchFlowFromEndpoint(e){let t=this.selected_project.id;return _().get(`https://portal.fl0.com/api/workspaces/${t}/flows/${e}`,{headers:{Authorization:`${this.bearer_token}`}}).then((e=>e.data)).catch((e=>(console.log("Error fetching flow",e),!1)))},async fetchVulns(e){return _().post("https://api.fl0.com/eliastest/uat/snyktest/flows/scan-js-code",{code_content:f.Buffer.from(e).toString("base64")}).then((t=>{console.log("Response",t);let s=t.data.map((t=>{if(t)return{type:t.ruleId,description:t.message.text,code:e}}));return s})).catch((e=>(console.log(e),[])))},showDialog(e){console.log("Clicked",e),this.dialog.show=!0,this.dialog.code=e.code,this.dialog.description=e.description}},watch:{bearer_token:function(e){localStorage.setItem("bearer_token",e)},workspace_id:function(e){localStorage.setItem("workspace_id",e)}}},m=g,b=(0,l.Z)(m,h,p,!1,null,null,null),y=b.exports;o["default"].use(u.Z);const k=[{path:"/",name:"home",component:y}],w=new u.Z({mode:"history",base:"/snyk-demo/",routes:k});var j=w,x=s(4665);o["default"].use(x.ZP);var C=new x.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}}),P=s(8209),S=s.n(P);s(243);o["default"].use(S());var F=new(S())({theme:{themes:{light:{primary:"#007BFF",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}}});o["default"].config.productionTip=!1,new o["default"]({router:j,store:C,vuetify:F,render:e=>e(d)}).$mount("#app")}},t={};function s(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,o,r,a){if(!o){var n=1/0;for(d=0;d<e.length;d++){o=e[d][0],r=e[d][1],a=e[d][2];for(var i=!0,l=0;l<o.length;l++)(!1&a||n>=a)&&Object.keys(s.O).every((function(e){return s.O[e](o[l])}))?o.splice(l--,1):(i=!1,a<n&&(n=a));if(i){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,r,a]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,n=o[0],i=o[1],l=o[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(l)var d=l(s)}for(t&&t(o);c<n.length;c++)a=n[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(d)},o=self["webpackChunksnyk_demo"]=self["webpackChunksnyk_demo"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[998],(function(){return s(7097)}));o=s.O(o)})();
//# sourceMappingURL=app.dde30329.js.map